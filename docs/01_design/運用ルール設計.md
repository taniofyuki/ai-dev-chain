# 運用ルール設計

本章では、AI開発自動化システムにおける開発フローの運用ルールを定義する。  
本ルールは、すべてのプロジェクトに共通して適用される。

---

## 1. フェーズ実行単位

### 1.1 フェーズの単位
**1フェーズ = 成果物の生成または更新を行い、GitHub 上で 1 つの Pull Request として提出する単位**とする。

### 1.2 フェーズ完了の定義
以下が満たされた時点で当該フェーズは完了とみなす。

- 成果物が生成または更新されている
- GitHub 上に Pull Request が作成されている
- レビューおよび承認が完了している
- Pull Request がマージされている

---

## 2. 承認ルール

### 2.1 承認の粒度
承認は **フェーズ単位** で行う。

- 成果物単位での個別承認は行わない
- Pull Request の承認 = フェーズ承認とする

---

## 3. 差戻しルール

### 3.1 差戻し時の挙動
差戻しが発生した場合は、**同一フェーズを再実行**する。

- 既存の Pull Request のブランチに修正コミットを追加する
- 新しい Pull Request は作成しない

### 3.2 フェーズの巻き戻し
前フェーズへの巻き戻しは **原則行わない**。  
必要な場合は手動対応とする。

---

## 4. フェーズ状態管理

### 4.1 定義される状態

| 状態 | 説明 |
|-----|-----|
| NotStarted | 未開始 |
| Running | AI による生成・修正処理中 |
| NeedsReview | レビュー待ち（PR 提出済み） |
| Approved | レビュー承認済み |
| Merged | PR マージ完了、フェーズ完了 |
| Blocked | 入力不足や矛盾等により処理停止 |

### 4.2 状態遷移

```
NotStarted → Running → NeedsReview → Approved → Merged
                    ↘
                     Blocked
```

---

## 5. テストフェーズの扱い

### 5.1 フェーズ構成
テストフェーズは、開発フロー上 **常に存在する**。

### 5.2 実行ルール
テストフェーズは以下のいずれかを明示的に選択する。

- 実行する
- スキップする

スキップした場合も、その判断は履歴として記録される。

